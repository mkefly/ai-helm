ai-workloads:
  aad:
    tenantId: 8f1c4e9a-7d49-4a7a-9a5b-2d4f2e6b9c01
    apiAudience: api://9f59e2de-5b75-4837-a4aa-8f30bc2b3d61

  requestAuth:
    enabled: true

  aadPolicies:
    - name: ns-all
      namespace: ai
      namespaceWide: true
      allowSameNamespaceInternal: true
    - name: runtime-openai
      namespace: ai
      allowedPaths:
        - /docs
      allowSameNamespaceInternal: true

  serviceAccount:
    create: true
    annotations:
      azure.workload.identity/client-id: 3b3c6b2c-1a2d-4e6a-9f22-03f2e7c1d8ab

  istio:
    enabled: true
    host: ai.example.com
    gateway:
      name: ai-workloads-gateway
      namespace: istio-system
    basePath: /apps
    timeout: 60s
    retries:
      attempts: 3
      perTryTimeout: 10s
      retryOn: 5xx,connect-failure,refused-stream

  apps:
    - name: mlserver-a
      kind: mlserver
      infraProfile: cpu-small
      replicas: 1

      image:
        repository: ghcr.io/acme/mlserver-a
        tag: v1.1.0

      settings: |
        {
          "models": [
            {
              "name": "fraud-detector",
              "implementation": "mlserver_sklearn.SKLearnModel",
              "parameters": {
                "uri": "/models/fraud-detector"
              }
            }
          ],
          "logLevel": "INFO"
        }

    - name: mlserver-b
      kind: mlserver
      infraProfile: cpu-medium
      replicas: 1

      image:
        repository: ghcr.io/acme/mlserver-b
        tag: v2.0.0

      settings: |
        {
          "models": [
            {
              "name": "recommendation",
              "implementation": "mlserver_sklearn.SKLearnModel",
              "parameters": {
                "uri": "/models/recommendation"
              }
            }
          ],
          "logLevel": "DEBUG"
        }

  batchTasks: []


