ai-workloads:
  apps:
    - name: mlserver-a
      kind: mlserver
      infraProfile: cpu-small
      replicas: 1

      image:
        repository: ghcr.io/acme/mlserver-a
        tag: v1.1.0

      settings: |
        {
          "models": [
            {
              "name": "fraud-detector",
              "implementation": "mlserver_sklearn.SKLearnModel",
              "parameters": {
                "uri": "/models/fraud-detector"
              }
            }
          ],
          "logLevel": "INFO"
        }

      hpa:
        enabled: true
        minReplicas: 1
        maxReplicas: 5
        metrics:
          - type: Resource
            resource:
              name: cpu
              target:
                type: Utilization
                averageUtilization: 60

    - name: mlserver-b
      kind: mlserver
      infraProfile: cpu-medium
      replicas: 1

      image:
        repository: ghcr.io/acme/mlserver-b
        tag: v2.0.0

      service:
        enabled: true
        type: ClusterIP
        ports:
          - name: http
            port: 9000
            protocol: TCP

      settings: |
        {
          "models": [
            {
              "name": "recommendation",
              "implementation": "mlserver_sklearn.SKLearnModel",
              "parameters": {
                "uri": "/models/recommendation"
              }
            }
          ],
          "logLevel": "DEBUG"
        }

      env:
        - name: MLSERVER_HTTP_PORT
          value: "9000"

      hpa:
        enabled: true
        minReplicas: 1
        maxReplicas: 10
        metrics:
          - type: Resource
            resource:
              name: cpu
              target:
                type: Utilization
                averageUtilization: 70

  batchTasks: []
